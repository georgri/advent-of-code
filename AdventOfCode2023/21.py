text = '''
...................................................................................................................................
..........#.............#...#........#....#.......#.#..#...........................##......#......#..#.###................#........
...#.#.......#.#......#.......#.........#.........#..#.#...........................................#........#...#.......#....#.#...
..#......#...#.........#...#......##......#.........#...........................#......##......##.....#...##.#....#...#............
......#...........#.............#......#.....#...#.#.#......................#..#...#.#......#..............#.......................
.#..........#.#.#.....................#......#...#.........................#.#...#...##......#.....#..#..........##................
.....#.#......#.........#.........##.....#..##.##..#.......................#.......###.#....#...#...#.......#.#..#.#..........##...
..#..#.....#....#..............................#...............#...................#...#.....#.#......#............................
..#..#........#....##..#.......#......#.#..##.................................#..#..................#................#....#........
.#..#........................#..#.....#.......##..............#............................#...........#.........#........###......
....#....#..#....#...#.........#.....#.#...#..#............#.......#...........##...##.#.#...#.....##..............................
....#..#.........#..#......#.....................##........#.........................#.............#.#....#.................#......
...#.......#......#............#......#...#....#...............#........#...............#...............##..#.#.......#..###..#....
......#..#.....#.....##...#..#.#..........................#..........................#........#.........................#......#...
.#.......##.........#.......#.#........................##..#...#...#.#.#................#..........#......#.......#...##..#..##.##.
..........#.............#.........#...##.................#.............#.#..............#.......##.....#..........#....#...........
.....#.#............#..#.............................#....##.............#...........#....#..........#.......................#.....
...................#................#................##......#.....#...##...#.............#.....#.......#.....................#....
.......#.#.#............#....##....#................#......#.#....#..#......#.#........................#.#...........#.....#.......
.....#.....#...###.......#.......#.#..#.................##.........##...........................##....#...##...........#...........
..#...#.........#...#..................#...........#.......#.#......#...#...................#..#.#..#......#..#.....#...........#..
.#...........#....#.....#.....#........#...........#..#..##...#...........#....##..............##........#...#...............#.#.#.
................#....#..#........#..#.#....................#................#.....#.............#..........#........#.....#..#.....
............................###...##...........#.#.....##....#....##..##...#..................##.........##............#..###......
.#..##........#.#......#...#.##....................#.........................#............................##....#..................
..#.........#..#.........#........................#.....##.............##.....#...............##........#....####..................
...#.#.##........................#.#...........#........##........................#............#.#.....#..........#....#...........
....#....#.....##...........#.....#..........#...#...#..............#...........#...............#...............#.....#....#.......
.#.........#....#.#................................#.....#.....#....#........#.........##.............#..#....#.......#.....#..#...
......##.....#.......#..........#.........#.#.........##....##.#...........##...#.#.......#......................#.................
..............#............#............#..............#.#.........###....#.#.......#.....#.......................#....#....#.#....
............##.....#.#.......#.........#.#..#..#.........#......#....#.....#....#.......................#.....#......#.............
..#.#....#....#.........##..#...................#..#..............#.......#.............................##...............#.........
.#....#...............#...#..........#..........#.........###..#.......#..##........#.#.....#..........#.....#.............#.......
.......#....#..........#.......................#..##.#.............#......................................#..............#...#.....
..#.##..........#............................#.............#..........#....#.......#...#..##.................................#.##..
......#...#..........#......................................#...........#..#.......#......#.#..............................#...#...
.#.#................##............#.......##......................#..#..#.....#.#..........#......................##...............
..#........#........#.............#..........#.....#..................#........#........#.................................#........
.###..##..#........................#.#......#........##.....#.....#......#..#........#.....#.................#...#.......#.........
.......#......#................#......#......##...............#................#....#..#...#....................###.....#.....#....
..#...........#...............................#...##....##...........#.#.#........................#................#......#......#.
....#..#.#...........................#....#.#..............#............#..#..##................#...............#..#..#.......##...
....##.#.......................#.....................#....#...................#.....#...#..............#.........#.#........#..#...
...##..........##........#.....#..........##...#..........................#.........#..#..#......#....................#.....##.....
..#......#...................#..#.##.........#.......#........................#.#.#.........................................#....#.
.#....####................#....#.#..#.#......#................#.....................#.#....#........#..##..........................
...........#.#...........##...............#..........#......................##....#.......#...##.....#....................#..#.....
.#..#................#...................#..#........#.....#.............................#.#...##.....................#........#...
........##..#................#..#....#........#......#..#.............#..........#...........#..............#.........#....#.......
..##....##.#.........#.#........#...........##..###..#.......#..................................#.#......#..#..#............#.##...
...........................#...#..#..##....#...#.......................#.....#...#.................................................
..#..#..#...................#..............................................#..#......#.......#................#.#..........#.......
........#.......##..........#.......#............#.##...............#......#...........#...............#..................###......
.#.#................#.....#..#.#...#...........................#.....#..#..........#...............#.#.............................
..............#.......................#........#.#.................................#.......#...#....#........#.#....#........#.....
..##....................#....#....#.........#..##..........#.......##..................................#..#..##..#...#.............
...#.............#......#....#...##........#......................#.............#......##............#..........##.................
..................##......#.........#....#..........#.#........................##.##.........................##....................
................#........#..#......................#.........#..............#....#...#...#..........................#..............
...................##...##..............#..#..#.#...##.....#.........##...........................#...##.#.........................
............#......#..........#......#..#.....##......#.................#..........#......#...#.........#........##.#..............
.....................#.#........................#...............#......#.#..#.........#....#................#..............#.......
..................#......#.#.....#......#............##.....#.#........#.#........#...#....#.....##..........#...#.................
........#...............................#.......#.........#....#...###......##..#....#.........#..##.........#.....#.......#.......
.................................................................S.................................................................
.....#.#......#.......##.#..#....#..#..#..............#...............#.............##.....#...#.###............#..................
.............#.........#.........#...........##.....#...........#..............#...#.................#.#..................#........
.......#.#...................#..........#..............##....##.............#..........#..#..#.........##..........................
...........#....#..............##........#............#...#....##........#.#....#.#.#...............#...#....#..........#..........
...........##.#.#.#......#........#..#....#...#........................#.............#......##...##..#.#...##........#.............
..#.......##....#...........#..................#....#....#..#.......###......................#.......................#.#...........
..............#......#.#..#...#.#.......................................#.###.................#............#...#...................
............#.........#.#.........##......................#..........#.......#....#.................#........#...#..##...........#.
...............#....#...#......#.....#......#.....#.....#....##...............#...............#....#............#..#...............
....##.........#.#....#.........#.....#.#...........#...............#.....###.........#..............#.....#.......................
..#.#....................#.......#..........#....#...#....#..#......#..#.##...#.#.#..#.#.......................##..............#...
....#..................#...#..#................#..#.#.................##..#..........#....#..............#...#.....................
..#....#...............................#.....#.......#..............##.#......#....#..........#..#....#.#.................#........
......##.......................#.......#.......................#...#......##...#.........#..#.......#...................#..........
...##.#..............#.....#..#.#...#......##.......#.........#.#..............#.....#...#..#...#.........#........................
....##.#......................##.#...#.........#........................#.#.................#......##........#...............#..#..
....#...##...........#.....#................#..#........#....#.............#.#.......................#....................#........
........##........................................#................#......................#................#.........##.#....#...#.
....#......#............#................#..................#........#...#.................#.............#.........#..#.#..........
.#.........#...................................#..............#.#....................#..................................#.#..##..#.
..##..#.##................#............#........#...........................#......###..#.....#..#...#............#.#.#....#.......
..........#........................#..#....###..##...#..............###..............#..#....#.#.##..................#.......#.....
.....#..#....#..............................................#...................#..................#.................#........#..#.
.....#...#.......#..#......................#.#...#.....#..#...#......#..#....#.#..............#.#.....#.......##.#...###......#.#..
...........................................#.#............#....#........#........#...........#.#..............................#....
......#........##..#.............#.#...##..#......................#......#.........#.#....#.................#......................
.#.#...#.#..#.#....##..............##...#......#.#....#....#....#.##...................#...##...#....................#...#.........
.#...#...........#................................#...###.............#.....#.........#....##...#..............#.............#...#.
............#.....................#..#.#..#............#....#...............#.#.......#..##................#............##.........
..#............##.......#.#...........#....#...#.....#.........#...........#..........#......#..........#......#...#....##.........
....#...................................................#.....#...#.................#.......#.#..............#.......#.#.#..##.....
..#.........##.#.#......#..#.........#.#...........##....#.........#...............#..#.......#....................#...............
.#..#...........##.#..........................#...............#.........#.................#............#...#.........#...#.......#.
...........#.................#.............................#............................#...........#.....##..........#...#....#...
....##..............##.....#..#...........#.........#..#.....#..#...............#..........#...............##....#......#........#.
.#...#.....#...........#..................#...#..###....#.........#..........#..#..#....#.#........##.#..##......#..........#......
.....#.#.#......##...#..........#..........#......#....#.................................#...........#...#.......#.............#...
....................#.......#.............#.......#.#....#......#...............#.....#.........#...##...#...............#.#.....#.
.#......#..................................#...........#.#.....#..#..#.....#....#.......................#..#....###..#.....##......
.......#.......#.......#.#..#...............#.#..#..#...#.#.....#.....#............#..#................................#...#.....#.
.#........##...........#.....#.....#...............................##..##...#......................#...........................##..
...............#........#.....#.##............#.#.................#....#.#..........#..........#....................#.........#....
.........................#..#....#..................#......##...............................#..#.....#.#.#................#.#....#.
......#.....................#..#..#..................................#..##....#................#...............#...#.#.............
....#.#.........#.............#.......#............#.....................................#.#.........#...#.......#....#.#..........
...#...##......#.#......#..#..#........###.................#.........#...#.#.............#.#...............#.............#.........
....#.......#.#.....#........#.........#...................#..#.....#....#...............#.........#...#.#.#.....#...........#.....
......#.#..........#..#..................#............................#..##...............##.....#..#..............................
............#.............................#.#...............#...#.....#..#.............#..........#.#...#......................#...
..#.###............................#.....#................#..##...##........#..........##........#........#.#......................
............###..........#..........#......#.............#...#.............#.......#..........#.#.....#......#..........#......#...
...#........#......#.............#.......#.....................#......##.................#.#........#.......................#.#....
.........#...#........#...#...##.#...#....#...#...................#.#.#............#.......#..#........#..#........#...............
.......................#..##.#.#.......#....#....#.....................................##...#........#.......................#.....
...#.##..#................#........................................##............#........#.......###.#.......#......#.#...........
......#....#......#..................#.....#......#.#.................................#.##..#.#.#.............#....#......#........
....##.....#.......##......#.#.....##.#........................#..............#........#..#....#................#.#.#..#....#......
......#.....#......#...#......##...#...........#....#..........................##.#..#..........#..#...............#....##..#...##.
...................#.#.......#.........#........#.................#.........#.......................#...#...#..#....#.#.....##.....
....#..#...#.#.#...#.#........................#........##.................#..........#.#.............#.....#....#..........##...#..
.....................##..........#....#....##...#..#...............................#........#...........#......#..##..#............
....#....##..#...#.......##..#....#..#........#.........................#...#....#.....#..........................#..##..#....#....
.................................#...#..#...#.#......#....#............#.......#......##.#.#.#....#............................#...
.......#.........#........#.###..................#..#.#.........................#.....#............#.............#......#..........
...................................................................................................................................
'''

text_test = '''
...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........
'''

def read(text):
    res = []
    for line in text.split('\n'):
        if not line:
            continue

        res.append(list(line))

    return res


print(read(text_test))


def get_marked(m):
    for i, line in enumerate(m):
        for j, c in enumerate(line):
            if c in 'SO':
                yield(i, j)


def adj(m, x,y):
    for xo,yo in ((0,1),(0,-1),(1,0), (-1,0)):
        if 0 <= x+xo < len(m) and 0 <= y+yo < len(m[0]):
            yield x + xo, y + yo


def step(m, marked):

    for x,y in marked:
        m[x][y] = '.'

    for x, y in marked:
        for a,b in adj(m, x,y):
            if m[a][b] == '#':
                continue
            m[a][b] = 'O'

    return m

def solve(text, steps):
    m = read(text)

    for _ in range(steps):

        s = list(get_marked(m))
        m = step(m, s)

    s = list(get_marked(m))

    print(len(s))



def adj2(x,y):
    for xo,yo in ((0,1),(0,-1),(1,0), (-1,0)):
        yield x + xo, y + yo

def step2(m, marked):
    res = set()
    sizex, sizey = len(m), len(m[0])
    for x, y in marked:
        for a,b in adj2(x,y):
            if m[a%sizex][b%sizey] == '#':
                continue
            res.add((a,b))

    return tuple(res)

#solve(text, 64)

def solve2(text, steps):
    m = read(text)

    s = get_marked(m)

    for i in range(steps):
        s = step2(m, s)
        if (i+1) % len(m) == len(m) // 2:
            print(i+1, len(s))
    print(len(s))

# solve2(text, 1000)

# WTF IS THE SOLUTION???
# well, I can store steps by plot coords and cache plot states.
# also I can predict the state of any given plot after 26.5 steps.
# but the edge of 26.5M radius is enormous, how can I predict it fast?
# I can predict the final state of the each plot after I get a single 'O' in any cell.

# Note: THE VERTICAL PATHS FROM S ARE FREE OF ANY blocks!
# so, I can quickly predict the state of the maps on the cross - vertically and horizontally from S.
# It would be somewhere like 200_000 maps in EACH direction after 26mil
#

# Note: the edges of map are free of any blocks!

# Note: the pattern of reached maps wouldn't be a sphere - it would be a rombus.
# it would be an exact rombus!!!: the propagation would be the fastest by straights and edges only!!!

# So, it would exhibit clear periodicity.
# the area of a rombus is proportional to a square of its diagonals.
# so, if i can find periodicity of squares, i'll be golden :)

# Note:
# (26501365-65) / 131 = 202300
# so, let's look at i % len(m) == len(m) // 2

''' OK, IT'S OFF BY ONE :)
65 4015    - diff = 4015  - diff2 = 
196 34693  - diff = 30678  
327 95641  - diff = 60948 - diff2 = 30270
458 186859 - diff = 91218 - diff2 = 30270
589 308347 - diff = 121488 - diff2 = 30270


HERE IS REAL:
65 3867     
196 34253   - diff = 30386
327 94909   - diff = 60656 - diff2 = 30270
458 185835  - diff = 90926 - diff2 = 30270
'''

res = 3867
diff = 30386
diff2 = 30270
for i in range(202300+1):
    print(i * 131 + 65, res)
    res += diff
    diff += diff2

# 619407408502915
# 619407408502915 too high

# 619407349431167 is correct! :)
print(res)

