text = r'''
\\.......\.............../-........|......................-......../..................../......./....|........
\.................\....\...../........|........|....../.\....-....-..................|../...|...\./...........
../...-.....................\./-.....-.........................../...........\|......\......--............/...
.......|........\...\.........../|...../.........../...../..../...../.................\.././..................
...........\|..........-.................|.|.............|.............|....|..|-...........-..-......./......
.............................-../.......\.........\..........................\.......|....|.........-.........
..................../......................-......-...................................../...\...........|.....
..|..............................\......................|....-................................................
..........\........./.........................|.................../....-|...../............./.....|.........//
.-./../.................|....................|................../................\....|..|..../|.......-./....
................/........................\...|.....-.....-...-........\.............../.......-|-./...........
.......\|.........|..-.........................|../...../.\.../............../.........|.....|../........\....
..............-./.............../...........................|....-....-..../......\....-.......\........./....
...............././.-.......|/...................../..-..-..\...\.-.-..-................../...................
..-......../.-.......\..............................\/....................................-...................
.........................................\....\.........\.-......-.|.....\.......................\............
./.........\.-.-/.............................................|/......|........-\-............................
-.....................|.........................|..\..........|..--....\..\........./.........................
...............\............../............\.........................-...............|................/....\..
.-.........-...........-|......../...............|.........-...-...|....................-.....................
.\./...............|......\..........-..\.................-...........................././../.-............/.-
...-/..............-..|........................|..../.......-..........-/...............\............../......
|..........-\..........\......../.................\.|.......-............../.......|.................../......
.....\...............|................/........\.....\..................-.../........................./.......
..............................-..\.../.........-..-........-.......-.............-......................|.../.
.........../../.|.......-/-.|.|...-...............................\\./....|................/.\................
.........-..............................|.||......................./........\..-..../.................|...../.
.............\...../\.............../...-......../.....\.....................................-/........\..|..\
...............-.-../.-./....|.......\................/...|................................................|.|
........-.................-.........................-................\......|.....\......-........-...........
|../.......|......\............|....../..|.......|../.........................................................
....................................../..\....\\.............\...................||/.../.../........\.........
............./..../....-...|........../-.............\......................................\/........-..-....
.................\\...............|\\...........\.........../......-.......-............\..............-..-..\
...|..../..|../..|........./.../.-..............................\.........-........................|.\....||..
......................./..|....-..............................-........................././../................
../.\.............//.\.|..................-.....\...........|..././............/.....................-........
|........|.......................|.......................\...-......\.......|./-.\...........................|
\..\......-.......|................|...............................-........\....-............................
./..........................................................\..............|-......./......................|..
.|...|..........|.\...-./../....|........\...................|......\.|.|......\...........-.-........./.../-.
................................||.\....................|.|\-............../..../.........\................./.
.......|\.....................................\........\........../...|......-.........../....................
......................\...-.-..|.................................../-..-./...-......................\......./.
..\..................../..../-.........-.................................................../-..\...-..........
...//....-......../..-.................\...-........\.../-../.\.....-\............../.................../.....
........./.............................................../|..|....../....................../..................
............/..........\..-...|....|.-\\.....|..............|.................-.....|.........................
...-..-................../......-................./.../................\......\|.......-./.\.....|............
.|..-...........-......\....-...-.........................\.............\......|..........-|..................
...........-..............\.....\........-.....|.......\.....................................-..\.....\./.....
.|....\.....|......./...|/.....\.......................|.................\................|....-............/.
........./....|...................................|..|.............../../......./.............................
...\|..-./....../........-.\................./..|.......|.................-....................\..............
...................\..|..-..-..................-......||.....\..\............\./............................-.
.......-........./...\.....|...................../.................\.\/.......\....|..........................
.....././................-............/.................../.......-............\.....|.|./...|..\.............
...................||.......\.|.........-........................|...\.../.............\..-..|............|...
......\...../.........|........|..|./..\....-...........................|..|..-...-..................../..../.
............................-../..............|.........|..............|.........-......-.....\...............
..............|............/........./................\........................../...........|................
..-.............-.|-......................-.|........././..././..........\...-..\........|....................
...../.......-............-........-........../.-.....--...................\..-......\..................|.....
....................\/|.......-...............................................-....\.............\....|...|...
...../.........../......\...........-..|............/.|....-........../....../...................\.|........-.
..........\...................-........|....|..........|....--.........................-....../...\..../....|\
......|................|..-................./......-.-.....-......./.../.................../..................
................../......\..|....-\.....................................\.-............../.-....|...-..../....
............-./...|-.............-.....|......|.....\-............-.............\-..........................|.
............-............../....\./............................/.....|.-............/-......../...............
............................./............/...............................-......\....-./../......-.........\.
..............................|\.\.....\...-.|../-.-..../.......................\../-...........-.............
...-|......|......-...|.........................\..--....-./................\|.-..........\...........|.|.-...
...-............./../........./..-../.......\...\..........\...................../....-.......-...-...........
....\........\................-.....-.........................|.........-.........\........-......../..-......
..........................-...............|./..-../..........|./........................|\..............-./...
................./.|...............................................-.................\./|....|................
.\.\.............|........-\....-../....|....-......./...........\..-...../............/..............|.......
.\.............\.........../....../.../.....................|.......................-\\...../.................
|./..-....../....|\..\..||............../...................../...........................................-...
..\.......\......\.../......../-.....-.-.............-.......................|....|../......|.|..\............
..\..|.....|........\......................\.......................|-...|....|....................../.......-.
.....\..............\.........\....................../........|.|.......\...............-..--..|..............
..-/............-....-../.|.......-.../..../..........\......../.....................\.-.................\..|.
....................|....|..........\..........|.......................................\-..\..................
........................../............................\.....|.............-..--......................|.......
....-......../...................-....\..../......\\.|..|.................................|...................
.-......\..-............../..........................-.../-....|/....\................-.......|....\...|......
...../..../..\.........-.........-......./.|.....|..../..\\...............\..|.../.....-........./.|\.\....../
......./.......\............../........-.......\........./..-........../........-...|....../-..........\....\.
......................\.......\/\...........|..\..\..........-........../................-............-.......
.......-.............\......|................-../......|......-.................../.......\\..................
.........../..............\........|..\.......|....../..../.........-............................|............
..../.....|...../.....-/..........-...................-../.................-..-.|............../.-....../.....
...............-...|.....|||......................-..|-.........\...\/.\.............../.../..................
.............|.......-.............................../..|.\../.........\/...|........|.\...\-...../.....-.....
....\.........\......................................................|../-........................./..........
...................../........................./........-..-....................../.\...............|.........
..............|....../.....\...................|...\\.....|.......|..............\........-......|./..........
........-.....|...|....../................-.......\-.|.........|...../.............../\.-...........|....\....
-....................\......../.......-.-.././.................\.../................|.../.....................
..............|-................/.....................|...................../.|.-|..........-./....|..-.......
..............|..|....|..........-.................-/\.......|-.............|.........../....../...........-..
../............................................................/..........\\.....\\...........................
...|..-\......................................-.//...\./...............-.......//................/............
.......\.........................|.........../....../...............-......-.....|.....................|......
...............|-..|.-......-....\..../........\.....-.-................\..\.-...\..../....-../.........-|....
.|-..........|\............/............./..|........|........../.....\........./......../..........|.........
..............|.............................../|..\..|................\......|...../......../..........\....\|
.../....|....../............................/..........\...\..|...-\.............../..-.\/...-....|.......-...
'''

text_test = r'''
.|...\....
|.-.\.....
.....|-...
........|.
..........
.........\
..../.\\..
.-.-/..|..
.|....-|.\
..//.|....
'''


def read(text):
    res = []
    for line in text.split('\n'):
        if not line:
            continue

        res.append(line)

    return res


def printl(text):
    for line in text:
        print(line)


printl(read(text_test))

# 0 right, 1 down, 2 left, 3 up
dir_map = {0: (0, 1), 1: (1, 0), 2: (0, -1), 3: (-1, 0)}

candidate_map = {'.': {0: [0], 1: [1], 2: [2], 3: [3]},
                 '-': {0: [0], 1: [0, 2], 2: [2], 3: [0, 2]},
                 '|': {0: [1, 3], 1: [1], 2: [1, 3], 3: [3]},
                 '/': {0: [3], 1: [2], 2: [1], 3: [0]},
                 '\\': {0: [1], 1: [0], 2: [3], 3: [2]}
                 }


def adj(start, d, m):
    x, y = start
    c = m[x][y]

    candidate_dirs = candidate_map[c][d]
    for direction in candidate_dirs:
        xo, yo = dir_map[direction]
        if 0 <= x + xo < len(m) and 0 <= y + yo < len(m[0]):
            yield x + xo, y + yo, direction


def dfs(start, d, m, visited):
    # search for unvisited neighbors
    stack = [(start, d)]
    while stack:
        start, d = stack.pop()
        for x, y, new_direction in adj(start, d, m):
            if visited[x][y] & (1 << new_direction) != 0:
                continue

            visited[x][y] |= (1 << new_direction)

            # recurse on neighbors
            stack.append(((x, y), new_direction))


def emulate_beam(lines, start, direction):
    visited = [[0] * len(lines[0]) for _ in lines]

    x,y = start
    visited[x][y] = (1 << direction)

    dfs(start, direction, lines, visited)

    return visited


def solve(text):
    lines = read(text)

    m = emulate_beam(lines, (0,0), 0)

    printl(m)

    # count #
    res = 0
    for line in m:
        res += sum(1 for a in line if a > 0)

    print(res)


#solve(text)


def count_res(m):
    res = 0
    for line in m:
        res += sum(1 for a in line if a > 0)
    return res


def solve2(text):
    lines = read(text)

    max_res = 0
    for i in range(len(lines)):
        # from left border, direction - right
        m = emulate_beam(lines, (i, 0), 0)
        max_res = max(max_res, count_res(m))

        # from right border to the left
        m = emulate_beam(lines, (i, len(lines[0])-1), 2)
        max_res = max(max_res, count_res(m))

    for i in range(len(lines[0])):
        # from top - down
        m = emulate_beam(lines, (0, i), 1)
        max_res = max(max_res, count_res(m))

        # from bottom - up
        m = emulate_beam(lines, (len(lines) - 1, i), 3)
        max_res = max(max_res, count_res(m))

    print(max_res)


solve2(text)
